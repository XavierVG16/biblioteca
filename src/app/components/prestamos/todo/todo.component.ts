import { OnInit, Component, ViewChild } from '@angular/core';
import { MatTableDataSource } from '@angular/material/table';
import { MatSort } from '@angular/material/sort';
import { MatPaginator } from '@angular/material/paginator';
import { PrestamoService } from '../../../services/prestamo.service';
import {Libro} from '../../../models/libro';
import { AuthService } from '../../../services/auth.service';
import {UsuarioService} from '../../../services/usuario.service'
import {Usuario} from '../../../models/usuario';
import pdfMake from 'pdfmake/build/pdfmake';
import pdfFonts from 'pdfmake/build/vfs_fonts';
pdfMake.vfs = pdfFonts.pdfMake.vfs;
@Component({
  selector: 'app-todo',
  templateUrl: './todo.component.html',
  styleUrls: ['./todo.component.css']
})
export class TodoComponent implements OnInit {
  displayedColumns: string[] = ['nombre', 'apellido','isbn_libro', 'titulo_libro', 'autor_libro', 'fecha_prestamo', 'fecha_devolucion','estado' ];
  dataSource;
  id: string;
  @ViewChild(MatPaginator) paginator: MatPaginator;
  @ViewChild(MatSort) sort: MatSort;
  pdfMake: any;
  random: number;
  applyFilter(event: Event) {
    const filterValue = (event.target as HTMLInputElement).value;
    this.dataSource.filter = filterValue.trim().toLowerCase();
  }
  constructor(public authService: AuthService, public usuarioService : UsuarioService, public prestamoService: PrestamoService) { }
  async loadPdfMaker() {
    if (!this.pdfMake) {
      const pdfMakeModule = await import('pdfmake/build/pdfmake');
      const pdfFontsModule = await import('pdfmake/build/vfs_fonts');
      this.pdfMake = pdfMakeModule.default;
      this.pdfMake.vfs = pdfFontsModule.default.pdfMake.vfs;
    }
  }


  ngOnInit(): void {
    this.ListaLibros();
    this.getUsuario();

  }
  getUsuario(){
    this.id = this.authService.getToken()
    this.authService.getUser(this.id)
    .subscribe(res => {
      
      this.authService.selectedUsuario = res as Usuario;
    }, error=>{
      console.log(error)
    })
  }
  ListaLibros(){
this.prestamoService.getPrestamos().
subscribe(res=>{
  this.prestamoService.libros = res as Libro[];
  this.dataSource = new MatTableDataSource(this.prestamoService.libros);
  this.dataSource.paginator = this.paginator;
  this.dataSource.sort = this.sort;

})
  }

  async Registros(inicio: HTMLInputElement, fin: HTMLInputElement){
    console.log(inicio.value, fin.value)
    await this.loadPdfMaker();
    this.prestamoService.postRegistro(inicio.value, fin.value)
    .subscribe(res=>{
      console.log(res)
      this.prestamoService.libros = res as Libro[];
      /**generar pdf */
      var arr =[];
      var f = new Array();
      f.push('NOMBRES' )
      f.push('LIBRO')   
      f.push('FECHA PRESTAMO' )  
      f.push('FECHA DEVOLUCION' )  
      f.push('ESTADO')  
      arr.push(f)

      this.prestamoService.libros.forEach(element => {
        var fila = new Array();
        fila.push(element.nombres+ ' '+element.apellidos )
        fila.push(element.titulo_libro )   
        fila.push(element.fecha_prestamo  )  
        fila.push(element.fecha_devolucion ) 
        if (element.estado_prestamo== '0'){
          fila.push('Entregado')  

        } 
        else{
          fila.push('Pendiente')  

        }
         
   
        arr.push(fila)

      });
      var hoy = new Date();
      var dd = hoy.getDate();
      var mm = hoy.getMonth()+1;
      var yyyy = hoy.getFullYear();
      const fecha_registro = yyyy+'-'+mm+"-"+dd;
      var reporte = '';
      this.random = Math.floor((Math.random()*1000)+1);

      if(this.random <= 9 ){
        reporte = 'ISTV000'+this.random;
     
 
    } else if(this.random >= 10 && this.random <= 99){
     reporte = 'ISTV00'+this.random;
   
 
    }else  if(this.random >= 100 && this.random <= 999){
     reporte = 'ISTV0'+this.random;
   
    }else if(this.random >= 1000 && this.random <= 9999){
     reporte = 'ISTV'+this.random;
    }
/***pdf */

var documentDefinition ={
    
  header: {
    columns: [
 
      { text: 'SISTEMA BIBLIOTECARIO VL', style: 'documentHeaderLeft' }
    ]
  },
 
  content: [
      // Header
      {
          columns: [
              {
                svg: `<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                width="1079.000000pt" height="1727.000000pt" viewBox="0 0 1079.000000 1727.000000"
                preserveAspectRatio="xMidYMid meet">
               <metadata>
               Created by potrace 1.16, written by Peter Selinger 2001-2019
               </metadata>
               <g transform="translate(0.000000,1727.000000) scale(0.100000,-0.100000)"
               fill="#000000" stroke="none">
               <path d="M5858 16921 c-25 -16 -55 -43 -67 -60 -44 -62 -89 -64 -116 -6 -28
               58 -77 52 -122 -16 -25 -39 -28 -50 -27 -128 0 -47 4 -113 8 -146 11 -84 6
               -87 -152 -95 -133 -7 -127 -5 -290 -83 -48 -23 -67 -51 -75 -116 -9 -71 -55
               -82 -93 -21 -12 19 -34 47 -49 62 l-27 27 -126 -6 c-70 -3 -133 -10 -140 -16
               -9 -7 -12 -22 -8 -41 16 -87 66 -380 76 -446 6 -41 17 -115 25 -165 13 -80 32
               -217 81 -580 8 -60 21 -146 29 -190 20 -113 32 -203 55 -410 11 -99 24 -211
               30 -250 9 -67 12 -102 44 -410 24 -222 57 -573 96 -995 19 -212 48 -639 70
               -1035 22 -413 37 -891 54 -1840 l5 -270 -62 -60 c-35 -33 -76 -71 -92 -84 -17
               -13 -66 -56 -110 -96 -44 -39 -91 -80 -104 -91 -13 -10 -51 -43 -85 -73 -82
               -72 -300 -243 -400 -313 -84 -60 -155 -98 -266 -144 -155 -63 -220 -104 -307
               -191 -208 -207 -265 -523 -168 -928 15 -59 16 -102 11 -270 -5 -200 -37 -566
               -57 -660 -10 -46 -36 -201 -59 -353 -6 -34 -25 -138 -44 -230 l-33 -167 -122
               -185 c-66 -102 -147 -223 -178 -269 -32 -46 -82 -120 -111 -165 -29 -44 -81
               -119 -116 -166 -35 -47 -87 -120 -117 -164 -29 -43 -70 -97 -90 -120 -19 -22
               -61 -76 -93 -118 -71 -98 -86 -100 -151 -23 -26 30 -56 55 -66 55 -16 0 -95
               -98 -288 -359 -19 -25 -37 -48 -40 -51 -3 -3 -40 -48 -81 -100 -156 -196 -329
               -404 -480 -577 -88 -101 -124 -140 -323 -349 -42 -44 -77 -87 -77 -96 0 -13
               24 -48 75 -110 8 -10 20 -18 25 -18 11 0 179 172 265 270 26 30 77 87 114 125
               36 39 86 95 111 125 24 30 61 73 81 95 46 49 220 263 331 405 45 58 102 130
               128 160 26 30 63 80 83 110 62 94 63 95 90 92 18 -1 51 -28 109 -89 128 -133
               482 -497 585 -600 51 -51 100 -104 109 -118 9 -14 24 -25 33 -25 18 0 103 85
               114 113 7 18 -106 139 -560 595 -101 101 -183 191 -183 199 0 8 25 38 56 67
               31 28 89 92 130 141 40 50 97 119 126 155 29 36 62 78 72 95 22 33 21 32 73
               96 21 26 61 79 88 118 28 39 82 116 122 171 63 87 237 342 285 418 21 33 75
               282 126 577 93 538 104 638 106 970 1 238 0 256 -26 374 -35 156 -36 249 -4
               368 27 102 48 148 103 219 65 87 181 169 291 205 165 54 306 149 702 469 37
               30 96 80 130 110 34 30 112 99 173 154 62 54 132 117 157 140 148 137 240 195
               357 222 83 19 135 14 268 -27 55 -17 120 -37 145 -44 25 -8 86 -27 135 -44 50
               -16 142 -44 205 -61 63 -18 140 -45 171 -62 51 -27 61 -29 106 -20 29 5 153 6
               294 1 325 -10 362 -16 385 -62 12 -23 15 -50 12 -108 -4 -71 -8 -82 -41 -125
               -30 -38 -37 -56 -37 -90 0 -37 -7 -51 -54 -106 -128 -152 -324 -297 -496 -367
               -19 -8 -62 -26 -95 -41 -134 -60 -347 -100 -525 -100 -215 1 -349 50 -469 172
               -92 93 -128 217 -117 403 6 121 2 135 -44 135 -32 0 -45 -23 -60 -104 -23
               -133 -1 -327 46 -413 59 -107 146 -203 215 -239 19 -9 37 -22 41 -28 17 -25 7
               -64 -25 -102 -19 -21 -40 -50 -46 -63 -86 -162 -444 -479 -723 -639 -85 -49
               -116 -85 -96 -109 18 -22 44 -15 148 37 144 72 152 70 144 -47 -2 -37 -13
               -243 -24 -458 -26 -501 -46 -793 -70 -1030 -11 -104 -27 -263 -35 -353 -28
               -308 -38 -387 -53 -410 -16 -24 -85 -65 -257 -153 -94 -48 -110 -59 -110 -80
               0 -19 6 -25 29 -27 34 -4 122 26 218 74 76 38 90 41 108 19 10 -12 10 -30 1
               -88 -20 -117 -41 -299 -41 -348 0 -93 -46 -99 -116 -14 -42 51 -173 169 -251
               225 -26 19 -54 41 -62 48 -8 7 -26 21 -40 30 -134 84 -331 216 -396 265 -174
               132 -336 329 -377 460 -10 33 -24 67 -30 74 -16 19 -46 16 -53 -6 -14 -45 59
               -225 138 -341 45 -65 219 -236 312 -306 82 -61 161 -114 170 -114 18 0 402
               -274 472 -336 145 -131 186 -172 194 -192 9 -23 -7 -159 -36 -307 -15 -74 -19
               -103 -40 -258 -15 -112 -13 -109 -132 -208 -96 -81 -153 -151 -216 -269 -95
               -176 -144 -320 -108 -320 24 0 63 49 106 132 79 156 135 243 219 344 32 39 85
               49 87 17 2 -34 -3 -68 -16 -118 -8 -27 -17 -75 -20 -105 -4 -30 -17 -118 -30
               -195 -13 -77 -26 -162 -30 -190 -3 -27 -13 -72 -21 -100 -13 -46 -13 -52 4
               -74 10 -14 31 -29 48 -34 65 -21 70 -49 22 -119 -41 -60 -62 -65 -105 -28 -19
               17 -37 30 -41 30 -4 0 -27 -29 -50 -65 -34 -51 -41 -68 -33 -82 5 -10 102
               -112 215 -227 145 -146 206 -215 206 -231 0 -12 -15 -42 -34 -66 -18 -25 -82
               -121 -140 -214 -110 -175 -191 -295 -251 -376 -19 -25 -35 -55 -35 -66 0 -18
               8 -21 83 -25 45 -3 90 -1 100 4 10 5 40 44 67 86 27 42 72 110 99 150 28 40
               85 130 127 200 84 139 131 215 175 279 16 23 29 51 29 63 0 14 -66 87 -200
               222 -110 111 -200 209 -200 218 0 9 21 44 48 78 64 83 86 83 162 3 30 -32 62
               -71 70 -87 56 -110 179 -252 275 -317 33 -22 76 -53 95 -68 88 -70 420 -228
               496 -236 39 -5 42 -3 89 54 60 71 94 103 111 103 20 0 34 -34 34 -84 0 -64 41
               -110 113 -126 28 -6 77 -18 109 -26 31 -8 112 -19 180 -24 67 -5 149 -14 180
               -19 103 -17 378 -23 530 -12 217 16 332 37 408 73 36 17 85 35 109 40 129 24
               270 149 344 306 34 73 50 187 38 276 -9 69 5 108 51 136 47 28 67 25 128 -20
               75 -56 107 -64 187 -50 81 14 111 29 152 75 36 41 38 65 16 181 -15 79 -69
               455 -104 719 -11 77 -30 217 -44 310 -14 94 -30 213 -36 265 -6 52 -16 129
               -22 170 -5 41 -28 239 -49 440 -22 201 -45 409 -51 462 -11 84 -10 100 3 120
               15 23 162 125 258 180 61 35 120 96 196 203 35 50 119 167 186 262 68 94 131
               184 141 200 9 15 33 51 53 78 41 58 112 203 174 356 l43 106 -37 119 c-21 65
               -38 124 -40 129 -5 16 -20 52 -71 165 -45 101 -86 160 -110 160 -6 0 -18 11
               -25 25 -18 33 6 70 52 79 48 9 183 90 213 129 35 43 77 141 110 252 23 76 26
               103 21 170 -9 135 -82 324 -171 443 -25 33 -45 66 -45 74 0 8 28 44 63 80 63
               66 92 107 185 256 68 108 70 119 38 195 -14 34 -57 152 -97 262 -39 110 -77
               214 -84 230 -7 17 -18 46 -24 66 -19 58 -72 104 -144 122 -78 21 -180 37 -233
               37 -52 0 -86 26 -74 56 4 11 35 34 68 52 64 34 149 112 194 178 38 55 78 174
               78 232 0 56 -32 126 -114 252 -27 41 -66 100 -85 130 -20 30 -39 57 -42 60 -3
               3 -13 19 -22 35 -9 17 -36 53 -61 80 -25 28 -46 53 -46 57 0 3 -19 20 -42 37
               -51 38 -65 38 -369 12 -148 -13 -225 -24 -247 -35 -43 -22 -81 -21 -90 3 -4
               11 -4 87 0 168 3 81 11 270 18 418 6 149 13 295 15 325 3 30 11 177 20 325 21
               365 53 817 71 1000 16 161 32 330 65 685 49 531 154 1441 179 1555 5 22 14 81
               20 130 42 325 113 797 131 868 13 51 -5 79 -62 97 -59 18 -299 15 -374 -5 -57
               -14 -101 -8 -135 20 -40 34 -106 57 -173 61 -112 8 -133 13 -161 39 -25 24
               -26 27 -26 152 0 100 -3 133 -16 151 -16 23 -48 29 -59 12 -3 -5 -21 -10 -38
               -10 -26 0 -40 9 -76 51 -55 64 -76 72 -133 51 -55 -19 -72 -13 -97 36 -24 48
               -53 57 -112 37 -38 -14 -48 -14 -97 1 -64 18 -84 15 -149 -26 -31 -19 -97 -42
               -184 -65 -75 -19 -148 -39 -163 -45 -51 -19 -82 -11 -153 37 -37 25 -93 63
               -124 85 l-57 38 -159 0 c-158 0 -159 0 -205 -29z m274 -32 c44 -22 130 -80
               163 -109 30 -27 146 -87 181 -94 18 -4 49 -1 75 8 47 16 114 33 244 61 44 10
               109 33 146 52 58 30 68 33 95 22 16 -6 55 -11 88 -10 57 1 59 0 101 -45 38
               -42 45 -46 76 -41 120 22 104 26 174 -44 35 -35 75 -74 89 -86 30 -26 35 -76
               10 -111 -13 -19 -24 -22 -83 -22 -54 0 -72 -4 -89 -20 -12 -12 -22 -27 -22
               -34 0 -7 -9 -25 -20 -39 -25 -32 -55 -26 -77 17 -29 58 -42 66 -102 66 -90 0
               -169 31 -231 89 -8 8 -39 25 -70 39 -81 37 -232 42 -363 12 -90 -21 -98 -21
               -150 -6 -32 9 -92 16 -142 16 -87 0 -87 0 -119 -35 -36 -39 -59 -43 -111 -18
               -33 16 -38 16 -97 -5 -35 -12 -94 -29 -131 -37 -92 -21 -115 -10 -140 65 -22
               67 -11 107 26 95 71 -22 73 -22 147 58 79 83 129 122 204 154 64 28 77 28 128
               2z m682 -441 c33 -17 66 -37 75 -45 28 -29 153 -82 208 -89 63 -8 76 -22 99
               -106 17 -66 72 -359 84 -451 5 -41 15 -76 26 -88 37 -41 94 -11 94 50 0 20 11
               115 25 211 48 334 55 364 87 381 29 15 104 2 160 -28 40 -22 54 -25 101 -19
               71 9 129 -6 188 -50 60 -44 125 -58 196 -44 94 20 123 -2 137 -102 12 -81 60
               -90 81 -16 26 90 75 106 75 25 0 -25 -6 -62 -14 -83 -21 -63 -54 -278 -126
               -834 -22 -173 -45 -340 -50 -371 -12 -64 -53 -420 -75 -639 -8 -80 -21 -215
               -30 -300 -34 -341 -56 -588 -75 -845 -11 -148 -24 -317 -30 -375 -44 -444
               -106 -1661 -97 -1887 5 -128 5 -134 -19 -165 -64 -88 -152 -228 -168 -267 -27
               -69 -52 -97 -129 -150 -88 -60 -145 -128 -203 -246 -33 -65 -49 -113 -58 -174
               -20 -121 -37 -126 -178 -51 -51 28 -140 75 -198 105 -58 30 -130 69 -160 87
               -30 17 -77 44 -105 58 -104 56 -558 325 -647 384 -47 32 -114 75 -239 156 -66
               43 -242 163 -452 308 -147 102 -142 94 -144 215 -12 490 -66 1383 -88 1438 -3
               9 1 23 9 32 24 23 67 7 124 -47 86 -81 660 -480 807 -561 28 -15 59 -35 70
               -45 11 -10 40 -29 65 -42 25 -14 59 -34 77 -44 82 -49 170 -100 184 -106 9 -3
               41 -22 72 -42 31 -20 58 -36 60 -36 2 0 46 -23 98 -51 141 -77 577 -293 634
               -315 28 -10 85 -35 127 -56 43 -21 90 -41 105 -44 16 -4 49 -17 75 -30 78 -39
               133 -27 89 20 -12 13 -67 44 -124 70 -56 26 -120 56 -142 66 -97 45 -529 264
               -620 314 -55 30 -143 77 -195 105 -52 28 -138 77 -191 109 -53 31 -130 77
               -170 101 -41 24 -103 62 -139 86 -36 23 -80 50 -98 59 -33 17 -391 249 -472
               306 -25 17 -128 90 -230 161 -102 71 -192 138 -200 148 -12 13 -20 73 -33 227
               -27 320 -46 544 -62 714 -22 231 -94 897 -105 960 -5 30 -25 177 -45 325 -20
               149 -61 443 -92 655 -31 212 -59 414 -64 450 -4 36 -13 79 -19 95 -20 51 -29
               118 -19 137 24 44 83 8 114 -67 10 -22 23 -53 30 -70 8 -16 32 -77 55 -135 23
               -58 45 -115 50 -128 15 -34 54 -48 83 -29 22 14 24 23 30 136 9 162 26 309 40
               345 8 22 28 37 86 64 65 30 91 36 181 42 135 10 321 38 452 70 85 21 95 8 163
               -225 25 -88 54 -182 64 -210 10 -27 22 -70 26 -95 4 -25 14 -53 23 -62 20 -23
               55 -23 76 1 15 16 16 36 6 212 -5 107 -10 245 -10 307 0 99 2 114 20 132 26
               26 47 25 112 -5 66 -31 84 -31 145 0 99 51 228 52 327 3z m-1491 -5690 c12 -6
               27 -17 32 -23 6 -6 37 -32 70 -57 285 -214 564 -401 895 -600 63 -38 122 -73
               130 -78 83 -52 257 -148 385 -214 122 -62 138 -73 148 -98 12 -33 -16 -41
               -104 -29 -45 6 -119 11 -164 11 -68 0 -100 6 -186 36 -57 19 -163 53 -235 74
               -73 22 -163 51 -200 64 -118 42 -226 74 -294 86 -138 25 -336 -12 -435 -82
               -33 -23 -50 -29 -69 -24 l-26 6 -2 393 c0 215 -1 399 0 407 0 8 -4 37 -10 63
               -5 26 -7 54 -4 62 7 18 39 19 69 3z m3397 -134 c28 -24 72 -80 176 -224 21
               -30 67 -102 102 -160 54 -90 62 -110 58 -142 -7 -60 -90 -175 -166 -230 -36
               -26 -108 -79 -160 -118 -103 -75 -181 -125 -274 -173 -33 -16 -85 -53 -115
               -81 -131 -120 -217 -175 -321 -205 -62 -19 -83 -21 -120 -12 -38 9 -49 7 -83
               -12 l-38 -21 -43 22 c-53 29 -140 114 -173 170 -29 49 -63 170 -63 225 0 28 8
               49 30 76 25 31 32 51 38 109 8 67 11 74 57 124 62 66 76 79 150 136 76 58 81
               65 94 129 10 54 26 81 94 165 56 69 210 195 254 208 21 6 115 17 208 24 256
               20 259 20 295 -10z m218 -1164 c105 -12 187 -34 215 -58 23 -21 49 -78 107
               -242 27 -74 56 -155 64 -179 9 -24 25 -58 36 -76 27 -44 26 -96 -3 -132 -13
               -15 -45 -59 -70 -98 -62 -95 -108 -147 -175 -198 -59 -45 -321 -187 -345 -187
               -8 0 -28 7 -45 16 -35 17 -34 18 -114 -44 -32 -24 -98 -64 -148 -90 -50 -26
               -110 -57 -133 -69 -40 -22 -77 -31 -382 -102 -152 -35 -340 -56 -434 -48 -37
               3 -137 -3 -231 -14 -197 -23 -210 -25 -280 -51 -104 -38 -166 -22 -253 66 -46
               45 -60 68 -77 122 -11 36 -20 82 -20 101 0 88 47 180 111 217 51 29 84 58 98
               83 6 12 33 35 59 50 26 15 61 37 77 49 17 12 66 39 110 61 116 58 332 171 390
               203 28 16 88 45 135 65 47 20 92 42 100 49 8 7 40 23 70 35 30 13 92 41 137
               62 79 38 187 68 246 69 27 0 36 13 17 25 -5 3 -10 23 -10 45 0 35 3 39 43 55
               23 9 70 35 105 56 55 35 181 98 262 131 89 37 180 45 338 28z m-1337 -285 c37
               -25 70 -52 73 -61 9 -22 -19 -51 -56 -59 -31 -7 -51 -17 -108 -53 -41 -26 -63
               -28 -81 -6 -10 13 -10 22 0 52 8 20 19 44 26 52 7 8 17 33 20 55 15 79 33 82
               126 20z m-1074 -821 c3 -8 -2 -42 -12 -74 -29 -96 -18 -205 33 -313 22 -47 51
               -95 65 -107 14 -12 31 -36 38 -53 11 -27 10 -32 -10 -48 -13 -11 -30 -19 -38
               -19 -39 0 -190 -63 -401 -167 -212 -105 -238 -121 -301 -181 -108 -106 -161
               -232 -161 -386 0 -289 184 -524 432 -552 60 -7 88 -23 88 -50 0 -9 -10 -37
               -21 -65 -18 -41 -21 -63 -17 -142 3 -81 8 -103 35 -158 36 -72 111 -154 187
               -205 112 -74 301 -112 511 -101 150 8 379 61 436 101 19 13 50 16 151 16 139
               0 290 19 406 50 62 17 78 18 100 8 27 -13 27 -13 44 -213 15 -181 32 -354 58
               -595 5 -47 14 -130 19 -185 30 -292 74 -670 87 -745 8 -47 23 -161 34 -255 10
               -93 21 -183 24 -200 3 -16 10 -66 16 -110 61 -460 100 -735 120 -834 15 -77
               13 -98 -11 -122 -30 -30 -82 -20 -128 25 -68 64 -147 84 -210 51 -59 -30 -149
               -95 -214 -154 -121 -110 -132 -114 -268 -119 -172 -6 -162 -24 -157 259 3 242
               0 259 -46 259 -40 0 -55 -22 -70 -100 -26 -137 -77 -335 -92 -357 -19 -30 -50
               -29 -177 3 -140 35 -177 48 -262 94 -41 22 -84 40 -96 40 -12 0 -74 -18 -138
               -41 -151 -54 -198 -66 -306 -84 -148 -23 -254 -28 -350 -16 -110 15 -145 32
               -145 69 0 52 50 368 75 471 14 57 23 112 20 121 -11 35 -110 55 -133 28 -5 -7
               -22 -58 -37 -113 -15 -55 -39 -138 -55 -185 -36 -108 -70 -223 -70 -235 0 -6
               -11 -23 -23 -39 -21 -26 -29 -29 -88 -30 l-64 -1 -5 40 c-10 72 -25 79 -98 44
               -53 -26 -196 -37 -257 -20 -24 6 -88 47 -153 95 -62 47 -119 89 -126 93 -30
               18 -35 48 -20 119 8 38 19 92 24 119 14 70 77 483 100 650 11 77 38 266 60
               420 55 374 77 541 89 655 6 52 20 174 31 270 42 355 88 869 120 1350 10 162
               24 354 30 425 15 171 38 729 33 759 -8 38 24 83 85 122 116 75 260 206 354
               324 35 44 95 153 131 237 22 51 45 60 114 44 123 -27 391 -19 496 14 60 19
               106 18 114 -1z m2596 -85 c37 -17 94 -97 123 -175 35 -91 74 -232 74 -267 0
               -35 -51 -183 -87 -250 -26 -49 -35 -56 -138 -109 -122 -64 -114 -60 -275 -128
               -201 -83 -294 -116 -769 -271 -182 -60 -195 -63 -205 -46 -6 11 -16 26 -23 35
               -14 19 -10 21 -133 -61 -40 -27 -96 -57 -124 -69 -95 -37 -290 -88 -491 -128
               -110 -22 -236 -52 -279 -67 -158 -52 -404 -112 -487 -120 -45 -4 -63 -1 -90
               16 -23 14 -51 21 -85 21 -44 0 -58 5 -91 32 -49 41 -103 118 -129 183 -14 37
               -19 74 -19 140 1 108 20 153 99 230 28 28 61 63 74 77 12 14 39 35 60 46 20
               11 69 36 107 57 137 73 493 222 660 276 67 22 261 59 365 71 107 12 179 8 332
               -18 34 -6 39 -4 55 25 19 34 46 44 143 55 77 9 283 52 360 76 36 10 96 29 134
               40 40 12 120 50 185 89 83 49 133 73 176 81 33 7 74 18 90 26 17 7 78 31 138
               53 59 22 127 52 150 65 47 29 65 31 100 15z m-165 -1141 c44 -33 102 -103 102
               -124 0 -3 22 -56 49 -118 60 -137 86 -241 72 -294 -6 -20 -34 -77 -62 -127
               -28 -49 -54 -96 -57 -104 -23 -59 -319 -496 -468 -688 -46 -61 -59 -58 -245
               60 -30 19 -69 16 -69 -7 0 -21 84 -94 133 -115 70 -30 82 -90 20 -106 -12 -3
               -43 -25 -69 -50 -79 -77 -114 -60 -114 54 0 42 -7 101 -15 131 -8 30 -15 79
               -15 109 0 30 -5 82 -11 115 -17 98 -5 113 111 157 90 33 235 127 316 204 126
               119 109 157 -29 65 -170 -114 -523 -246 -777 -291 -201 -36 -187 -36 -195 1
               -9 42 -24 45 -82 21 -26 -11 -110 -38 -186 -60 -76 -22 -141 -42 -145 -45 -21
               -13 -182 -38 -294 -46 -139 -10 -178 -4 -178 29 0 30 -17 35 -74 21 -49 -12
               -55 -11 -102 13 -177 90 -261 230 -220 369 32 112 151 220 266 242 19 4 89 21
               155 37 66 17 163 41 215 54 52 14 129 31 170 40 192 41 264 62 385 110 77 32
               160 58 205 64 41 7 93 18 115 26 22 7 65 19 95 25 137 30 260 61 315 80 33 11
               101 32 150 46 99 27 222 69 330 114 39 15 77 30 85 32 28 8 66 -6 118 -44z
               m-3714 -4640 c11 -15 13 -34 9 -64 -4 -35 -2 -44 14 -52 16 -9 33 -4 84 22
               115 60 232 70 317 27 93 -47 295 -75 447 -60 215 20 447 69 523 109 50 27 66
               25 147 -15 39 -19 104 -43 145 -54 41 -11 120 -31 175 -45 167 -44 287 -52
               698 -46 11 0 40 23 67 50 27 27 55 50 63 50 79 0 25 -242 -77 -346 -46 -46
               -138 -112 -166 -119 -18 -4 -36 1 -60 17 -19 13 -40 27 -47 31 -19 12 -43 -22
               -43 -59 0 -32 -4 -37 -42 -54 -98 -42 -223 -54 -553 -54 -335 0 -337 1 -383
               55 -30 36 -51 37 -83 3 -23 -25 -28 -26 -89 -19 -90 9 -190 34 -222 57 -25 17
               -28 26 -27 71 1 66 21 175 37 204 17 30 15 88 -3 103 -19 16 -18 17 -180 -149
               -174 -180 -175 -181 -198 -181 -10 0 -45 13 -76 30 -31 16 -76 36 -100 45 -60
               21 -221 114 -228 132 -3 8 -1 31 5 51 15 48 3 61 -41 43 -79 -33 -88 -30 -177
               61 -45 45 -89 98 -97 116 -21 50 -6 62 78 62 58 0 70 -3 83 -22z"/>
               <path d="M7020 6533 c-36 -7 -49 -23 -19 -23 29 0 103 -49 117 -77 5 -10 12
               -36 16 -58 4 -22 14 -69 23 -105 l15 -66 -28 -47 c-23 -37 -39 -51 -80 -67
               -28 -12 -66 -34 -85 -50 l-34 -29 39 5 c42 5 171 71 198 101 20 22 24 55 14
               108 -28 147 -39 195 -57 231 -31 65 -64 86 -119 77z"/>
               <path d="M6590 9298 c0 -14 12 -36 28 -50 65 -62 272 -146 333 -136 20 4 12
               10 -41 35 -36 17 -75 34 -88 38 -48 14 -171 74 -179 87 -4 7 -18 22 -30 32
               -23 19 -23 19 -23 -6z"/>
               <path d="M3667 5140 c-14 -11 -37 -44 -51 -73 -129 -270 -301 -504 -434 -590
               -33 -21 -43 -33 -40 -50 5 -36 56 -26 137 27 139 93 268 266 360 486 18 41 43
               98 57 127 20 42 23 56 14 73 -13 25 -12 25 -43 0z"/>
               <path d="M3288 3747 c-21 -29 -48 -63 -61 -77 -12 -14 -38 -47 -57 -75 -18
               -27 -37 -52 -40 -55 -3 -3 -21 -27 -40 -55 -19 -27 -36 -52 -39 -55 -11 -9
               -88 -114 -107 -145 -10 -16 -57 -80 -104 -142 -47 -61 -113 -151 -147 -200
               -35 -48 -114 -158 -177 -243 -64 -85 -161 -218 -216 -295 -56 -77 -144 -198
               -196 -270 -52 -71 -97 -138 -100 -147 -6 -20 -44 -33 -71 -24 -11 3 -29 25
               -41 49 -12 23 -34 58 -48 77 -31 43 -221 301 -364 495 -152 206 -196 266 -278
               379 -84 116 -82 114 -143 186 -25 30 -55 70 -68 88 -12 17 -29 32 -38 32 -9 0
               -37 -19 -62 -42 -109 -100 -246 -224 -263 -240 -26 -26 -22 -60 12 -93 16 -16
               42 -47 57 -69 16 -23 64 -88 108 -146 77 -101 124 -165 230 -306 27 -36 62
               -80 77 -97 15 -18 28 -35 28 -38 0 -6 88 -124 190 -254 38 -49 91 -120 118
               -156 26 -37 70 -96 97 -132 28 -36 58 -76 67 -89 9 -12 34 -46 55 -74 163
               -219 255 -342 268 -362 9 -12 22 -22 29 -22 7 0 35 29 62 64 217 286 291 384
               318 421 17 24 64 86 104 138 40 52 87 115 105 140 59 82 161 219 232 311 39
               50 99 132 135 181 35 50 85 117 112 150 26 33 102 134 170 225 67 91 125 167
               128 170 4 3 26 34 50 70 23 36 55 79 70 95 15 17 63 82 105 145 42 63 91 129
               107 146 16 18 28 39 26 47 -5 26 -326 347 -345 347 -10 -1 -35 -24 -55 -53z"/>
               <path d="M3726 3352 c-13 -20 -31 -43 -40 -51 -32 -27 -18 -54 87 -162 56 -58
               112 -117 124 -132 37 -44 49 -38 114 47 16 21 29 46 29 55 0 19 -259 281 -278
               281 -6 0 -22 -17 -36 -38z"/>
               <path d="M4064 2998 c-15 -23 -31 -46 -36 -52 -25 -30 -173 -233 -233 -321
               -37 -55 -89 -128 -114 -162 -25 -35 -75 -106 -111 -158 -53 -78 -135 -193
               -178 -250 -4 -5 -32 -46 -61 -90 -30 -44 -67 -96 -83 -117 -47 -60 -97 -131
               -114 -163 -9 -16 -38 -57 -63 -90 -25 -32 -89 -121 -141 -196 -145 -208 -234
               -335 -305 -434 -36 -49 -88 -126 -116 -170 -28 -44 -67 -96 -86 -116 -21 -22
               -33 -44 -31 -55 3 -18 33 -19 828 -22 454 -1 840 0 858 3 26 5 45 22 93 83 33
               42 73 92 87 111 15 19 80 104 144 190 109 145 138 200 106 201 -7 1 -254 0
               -549 0 -295 0 -543 2 -552 6 -29 11 -20 57 18 100 41 44 79 94 191 247 43 59
               116 158 162 220 45 62 93 126 105 143 31 43 168 226 232 309 67 86 117 156
               189 261 30 45 78 110 105 144 42 52 49 66 40 82 -6 11 -66 76 -135 144 -68 69
               -136 140 -150 159 -37 49 -66 47 -100 -7z"/>
               <path d="M2106 1183 c-8 -10 -31 -38 -51 -62 -20 -24 -34 -50 -31 -57 6 -17
               151 -209 192 -256 18 -20 42 -55 53 -76 34 -68 47 -64 124 31 36 45 34 69 -7
               115 -31 33 -129 164 -188 251 -51 73 -68 83 -92 54z"/>
               </g>
               </svg>
                `,
                width: 120,
                fit: [120, 150],
                
                  
              },
                  
              [
                  {
                      text: 'Instituto Superior Tecnológico Vicente León', 
                      style: 'invoiceTitle',
                      width: '*'
                  }, 
                  {
                    stack: [
                         {
                             columns: [
                                  {
                                      text:'Codigo de Reporte', 
                                      style:'invoiceSubTitle',
                                      width: '*'
                                      
                                  }, 
                                  {
                                      text: `${reporte}`,
                                      style:'invoiceSubValue',
                                      width: 100
                                      
                                  }
                                  ]
                         },
                         {
                             columns: [
                                 {
                                     text:'Reportes del',
                                     style:'invoiceSubTitle',
                                     width: '*'
                                 }, 
                                 {
                                     text:`${inicio.value}`,
                                     style:'invoiceSubValue',
                                     width: 100
                                 }
                                 ]
                         },
                         {
                             columns: [
                                 {
                                     text:'Hasta',
                                     style:'invoiceSubTitle',
                                     width: '*'
                                 }, 
                                 {
                                     text:`${fin.value}`,
                                     style:'invoiceSubValue',
                                     width: 100
                                 }
                                 ]
                         }
                        
                     ]
                  }
              ],
          ],
          
      },
      // Billing Headers
     
      // Billing Details
      
     
      // Line breaks
      '\n\n',
      // Items
      {
        table: {
          // headers are automatically repeated if the table spans over multiple pages
          // you can declare how many rows should be treated as headers
          headerRows: 1,
            widths: ['auto', 'auto', 'auto', 'auto' , 'auto'],
  
          body:arr
           
          
        }, // table
     
      },

     
      {
         columns: [
             {
                 text:'',
             },
             {
                 stack: [
                     { 
                         text: '_________________________________',
                         style:'signaturePlaceholder'
                     },
                     { 
                         text: 'Administrador',
                         style:'signatureName'
                         
                     },
                     { 
                         text: `${this.authService.selectedUsuario.nombres} ${this.authService.selectedUsuario.apellidos} `,
                         style:'signatureJobTitle'
                         
                     }
                     ],
                width: 180
             },
         ]
     }
     
  ],
  styles: {
      // Document Header
      documentHeaderLeft: {
          fontSize: 7,
          margin: [5,5,5,5],

          alignment:'left'
      },
      documentHeaderCenter: {
          fontSize: 10,
          margin: [5,5,5,5],
          alignment:'center'
      },
      documentHeaderRight: {
          fontSize: 10,
          margin: [5,5,5,5],
          alignment:'right'
      },
      // Document Footer
      documentFooterLeft: {
          fontSize: 10,
          margin: [5,5,5,5],
          alignment:'left'
      },
      documentFooterCenter: {
          fontSize: 10,
          margin: [5,5,5,5],
          alignment:'center'
      },
      documentFooterRight: {
          fontSize: 10,
          margin: [5,5,5,5],
          alignment:'right'
      },
      // Invoice Title
      invoiceTitle: {
          fontSize: 25,
          bold: true,
          alignment:'left',
          margin:[0,0,0,5]
      },
      // Invoice Details
      invoiceSubTitle: {
          fontSize: 13,
          alignment:'left'
      },
      invoiceSubValue: {
          fontSize: 13,
          alignment:'right'
      },
      // Billing Headers
      invoiceBillingTitle: {
          fontSize: 14,
          bold: true,
          alignment:'left',
          margin:[0,20,0,5],
      },
      // Billing Details
      invoiceBillingDetails: {
          alignment:'left'

      },
      invoiceBillingAddressTitle: {
          margin: [0,7,0,3],
          bold: true
      },
      invoiceBillingAddress: {
          
      },
      // Items Header
      itemsHeader: {
          margin: [0,5,0,5],
          bold: true
      },
      // Item Title
      itemTitle: {
          bold: true,
      },
      itemSubTitle: {
          italics: true,
          fontSize: 11
      },
      itemNumber: {
          margin: [0,5,0,5],
          alignment: 'center',
      },
      itemTotal: {
          margin: [0,5,0,5],
          bold: true,
          alignment: 'center',
      },

      // Items Footer (Subtotal, Total, Tax, etc)
      itemsFooterSubTitle: {
          margin: [5,5,5,5],
          bold: true,
          alignment:'right',
      },
      itemsFooterSubValue: {
          margin: [0,5,0,5],
          bold: true,
          alignment:'center',
      },
      itemsFooterTotalTitle: {
          margin: [0,5,0,5],
          bold: true,
          alignment:'right',
      },
      itemsFooterTotalValue: {
          margin: [0,5,0,5],
          bold: true,
          alignment:'center',
      },
      signaturePlaceholder: {
          margin: [0,70,0,0],   
      },
      signatureName: {
          bold: true,
          alignment:'center',
      },
      signatureJobTitle: {
          italics: true,
          fontSize: 10,
          alignment:'center',
      },
      notesTitle: {
        fontSize: 10,
        bold: true,  
        margin: [0,50,0,3],
      },
      notesText: {
        fontSize: 10
      },
      center: {
          alignment:'center',
      },
  },
  defaultStyle: {
      columnGap: 10,
  }
}
this.pdfMake.createPdf(documentDefinition).open();

const pdfDoc = pdfMake.createPdf(documentDefinition);


/**---------------------------------------- */

    },error =>{

    })

  }
   RegistroPrestamo(){
    
    const def = { content: 'A sample PDF document generated using Angular and PDFMake' };
    this.pdfMake.createPdf(def).open();
  
  }
}
